<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/head :: headFragment}">
</head>

<body
    class="font-display bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark min-h-screen flex flex-col">
    <header th:replace="~{fragments/header :: headerFragment}"></header>

    <!-- Custom Styles for Ranking Page -->
    <style>
        .ranking-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }

        /* Dark mode support for ranking card */
        .dark .ranking-card {
            background: rgba(42, 38, 63, 0.95);
            color: #E5E7EB;
        }

        .stat-badge {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 99px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .stat-badge.eco {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .stat-badge.donate {
            background: #e3f2fd;
            color: #1565c0;
        }

        .stat-badge.sale {
            background: #fff3e0;
            color: #ef6c00;
        }

        .dark .stat-badge.eco {
            background: rgba(46, 125, 50, 0.2);
            color: #81c784;
        }

        .dark .stat-badge.donate {
            background: rgba(21, 101, 192, 0.2);
            color: #64b5f6;
        }

        .dark .stat-badge.sale {
            background: rgba(239, 108, 0, 0.2);
            color: #ffb74d;
        }

        .rank-number {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            width: 40px;
            text-align: center;
        }

        .dark .rank-number {
            color: #E5E7EB;
        }

        .rank-1 {
            color: #FFD700 !important;
            text-shadow: 0 2px 4px rgba(255, 215, 0, 0.3);
            font-size: 2rem;
        }

        .rank-2 {
            color: #C0C0C0 !important;
            text-shadow: 0 2px 4px rgba(192, 192, 192, 0.3);
            font-size: 1.8rem;
        }

        .rank-3 {
            color: #CD7F32 !important;
            text-shadow: 0 2px 4px rgba(205, 127, 50, 0.3);
            font-size: 1.8rem;
        }

        .profile-thumb {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #fff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .dark .profile-thumb {
            border-color: #403a59;
        }

        .ranking-table th {
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 16px;
        }

        .dark .ranking-table th {
            color: #9ca3af;
            border-color: #403a59;
        }

        .ranking-table td {
            vertical-align: middle;
            padding: 16px 8px;
            border-bottom: 1px solid #f8f9fa;
        }

        .dark .ranking-table td {
            border-color: #403a59;
        }

        .ranking-table tr:last-child td {
            border-bottom: none;
        }

        .ranking-table tr:hover {
            background-color: #fcfcfc;
        }

        .dark .ranking-table tr:hover {
            background-color: #2a263f;
        }

        /* Bootstrap Nav Pills Override for Tailwind feel */
        .ranking-nav-pills {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .ranking-nav-link {
            border-radius: 9999px;
            padding: 0.5rem 1.5rem;
            color: #6b7280;
            font-weight: 500;
            transition: all 0.2s;
            text-decoration: none;
            border: 1px solid #e5e7eb;
            background-color: #fff;
        }

        .dark .ranking-nav-link {
            color: #9ca3af;
            border-color: #403a59;
            background-color: rgba(42, 38, 63, 0.5);
        }

        .ranking-nav-link:hover {
            background-color: #f9fafb;
            border-color: #d1d5db;
        }

        .dark .ranking-nav-link:hover {
            background-color: #2a263f;
            border-color: #6b7280;
        }

        .ranking-nav-link.active {
            background-color: #8B5CF6;
            /* Primary */
            color: #fff;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
            border-color: transparent;
        }

        .dark .ranking-nav-link.active {
            color: #fff;
            border-color: transparent;
        }
    </style>

    <main class="flex-grow pt-24 pb-12 px-4">
        <div class="max-w-5xl mx-auto w-full">

            <!-- Title -->
            <div class="text-center mb-10">
                <h2 class="text-3xl md:text-4xl font-bold mb-3 text-text-light dark:text-text-dark">Rebirth Hall of Fame
                </h2>
                <p class="text-gray-500 dark:text-gray-400">ì§€ì† ê°€ëŠ¥í•œ íŒ¨ì…˜ì„ ì‹¤ì²œí•˜ëŠ” ë¦¬ë²„ìŠ¤ íˆì–´ë¡œë“¤ì„ ë§Œë‚˜ë³´ì„¸ìš”.</p>
            </div>

            <!-- My Ranking Section (Login Only) -->
            <div th:if="${isLoggedIn}" class="mb-10">
                <div class="ranking-card p-6 md:p-8 bg-white dark:bg-card-dark">
                    <div class="flex flex-col md:flex-row items-center gap-6 md:gap-10">
                        <!-- Left: Profile -->
                        <div class="flex flex-col items-center flex-shrink-0 min-w-[150px]">
                            <div class="relative inline-block mb-3 p-1 rounded-full overflow-visible"
                                th:classappend="${myRanking.activeDecoration}">
                                <img th:src="${myRanking.avatarUrl != null ? myRanking.avatarUrl : '/images/common/default_profile.png'}"
                                    class="w-24 h-24 rounded-full shadow-md object-cover border-4 border-white dark:border-border-dark relative z-10"
                                    alt="My Profile">
                            </div>
                            <h5 class="font-bold text-lg" th:text="${myRanking.userName}">My Nickname</h5>
                            <span class="text-xs text-primary font-bold bg-primary/10 px-2 py-1 rounded-full mt-1">ë‚˜ì˜
                                ë­í‚¹</span>
                        </div>

                        <!-- Right: Stats -->
                        <div class="flex-grow w-full">
                            <div class="grid grid-cols-3 gap-4 text-center">
                                <!-- Eco -->
                                <div class="bg-gray-50 dark:bg-background-dark/50 rounded-xl p-4">
                                    <div class="text-green-600 dark:text-green-400 font-bold text-sm mb-2">ì—ì½” í¬ì¸íŠ¸</div>
                                    <h3 class="text-2xl font-bold mb-1"><span
                                            th:text="${myRanking.ecoPointRank}">-</span> <span
                                            class="text-sm text-gray-400 font-normal">ìœ„</span></h3>
                                    <div class="text-xs text-gray-500 dark:text-gray-400"
                                        th:text="${#numbers.formatInteger(myRanking.ecoPoint, 0, 'COMMA') + ' P'}">0 P
                                    </div>
                                </div>
                                <!-- Donate -->
                                <div class="bg-gray-50 dark:bg-background-dark/50 rounded-xl p-4">
                                    <div class="text-blue-600 dark:text-blue-400 font-bold text-sm mb-2">ê¸°ë¶€/ìˆ˜ê±°</div>
                                    <h3 class="text-2xl font-bold mb-1"><span
                                            th:text="${myRanking.donationRank}">-</span> <span
                                            class="text-sm text-gray-400 font-normal">ìœ„</span></h3>
                                    <div class="text-xs text-gray-500 dark:text-gray-400"
                                        th:text="${myRanking.donationCount + ' íšŒ'}">0 íšŒ</div>
                                </div>
                                <!-- Sale -->
                                <div class="bg-gray-50 dark:bg-background-dark/50 rounded-xl p-4">
                                    <div class="text-orange-600 dark:text-orange-400 font-bold text-sm mb-2">íŒë§¤</div>
                                    <h3 class="text-2xl font-bold mb-1"><span th:text="${myRanking.salesRank}">-</span>
                                        <span class="text-sm text-gray-400 font-normal">ìœ„</span>
                                    </h3>
                                    <div class="text-xs text-gray-500 dark:text-gray-400"
                                        th:text="${myRanking.salesCount + ' íšŒ'}">0 íšŒ</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ranking List Section -->
            <div>
                <!-- Category Tabs -->
                <div class="ranking-nav-pills">
                    <a th:href="@{/ranking(type='eco')}" class="ranking-nav-link"
                        th:classappend="${currentType == 'eco' ? 'active' : ''}">ğŸŒ± ì—ì½” í¬ì¸íŠ¸</a>
                    <a th:href="@{/ranking(type='donation')}" class="ranking-nav-link"
                        th:classappend="${currentType == 'donation' ? 'active' : ''}">ğŸ ê¸°ë¶€ ë­í‚¹</a>
                    <a th:href="@{/ranking(type='sales')}" class="ranking-nav-link"
                        th:classappend="${currentType == 'sales' ? 'active' : ''}">ğŸ·ï¸ íŒë§¤ ë­í‚¹</a>
                </div>

                <!-- Ranking Table Card -->
                <div class="ranking-card overflow-hidden bg-white dark:bg-card-dark">
                    <div class="overflow-x-auto">
                        <table class="w-full ranking-table">
                            <thead class="bg-gray-50 dark:bg-background-dark/50">
                                <tr>
                                    <th class="w-20 text-center py-4">ìˆœìœ„</th>
                                    <th class="text-left py-4 pl-4">ì‚¬ìš©ì</th>
                                    <th class="text-right py-4 pr-8">
                                        <span th:if="${currentType == 'eco'}">ë³´ìœ  í¬ì¸íŠ¸</span>
                                        <span th:if="${currentType == 'donation'}">ê¸°ë¶€ íšŸìˆ˜</span>
                                        <span th:if="${currentType == 'sales'}">íŒë§¤ ì™„ë£Œ</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100 dark:divide-border-dark">
                                <tr th:each="ranker : ${rankings}" class="group transition-colors">
                                    <td class="text-center py-4">
                                        <div class="rank-number"
                                            th:classappend="${ranker.rank == 1 ? 'rank-1' : (ranker.rank == 2 ? 'rank-2' : (ranker.rank == 3 ? 'rank-3' : ''))}"
                                            th:text="${ranker.rank}">1</div>
                                    </td>
                                    <td class="py-4 pl-4">
                                        <div class="flex items-center">
                                            <div class="relative inline-block mr-4 p-1 rounded-full flex-shrink-0 overflow-visible"
                                                th:classappend="${ranker.activeDecoration}">
                                                <img th:src="${ranker.avatarUrl}" class="profile-thumb relative z-10"
                                                    alt="Profile">
                                            </div>
                                            <div>
                                                <h6 class="font-bold text-text-light dark:text-text-dark"
                                                    th:text="${ranker.nickname}">Nickname</h6>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="text-right py-4 pr-8">
                                        <span class="text-lg font-bold text-primary"
                                            th:text="${ranker.formattedScore}">1,200 P</span>
                                    </td>
                                </tr>

                                <!-- Empty State -->
                                <tr th:if="${#lists.isEmpty(rankings)}">
                                    <td colspan="3" class="text-center py-10 text-gray-400">
                                        ë­í‚¹ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.<br>ì—´ì‹¬íˆ í™œë™í•˜ì—¬ ì²« ë²ˆì§¸ ì˜ê´‘ì„ ì°¨ì§€í•˜ì„¸ìš”!
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="mt-8 flex justify-center" th:if="${totalPages > 0}">
                    <nav class="flex gap-2">
                        <a th:href="@{/ranking(type=${currentType}, page=${currentPage - 1})}"
                            th:classappend="${currentPage == 1} ? 'pointer-events-none opacity-50'"
                            class="w-10 h-10 flex items-center justify-center rounded-full bg-white dark:bg-card-dark border border-gray-200 dark:border-border-dark hover:bg-gray-50 dark:hover:bg-background-dark transition-colors">
                            <span class="material-symbols-outlined text-sm">chevron_left</span>
                        </a>

                        <a th:each="pageNum : ${#numbers.sequence(1, totalPages)}"
                            th:href="@{/ranking(type=${currentType}, page=${pageNum})}" th:text="${pageNum}"
                            th:classappend="${pageNum == currentPage} ? 'bg-primary text-white border-primary' : 'bg-white dark:bg-card-dark border-gray-200 dark:border-border-dark hover:bg-gray-50'"
                            class="w-10 h-10 flex items-center justify-center rounded-full border text-sm font-bold transition-colors">
                            1
                        </a>

                        <a th:href="@{/ranking(type=${currentType}, page=${currentPage + 1})}"
                            th:classappend="${currentPage == totalPages} ? 'pointer-events-none opacity-50'"
                            class="w-10 h-10 flex items-center justify-center rounded-full bg-white dark:bg-card-dark border border-gray-200 dark:border-border-dark hover:bg-gray-50 dark:hover:bg-background-dark transition-colors">
                            <span class="material-symbols-outlined text-sm">chevron_right</span>
                        </a>
                    </nav>
                </div>

            </div>
        </div>
    </main>

    <footer th:replace="~{fragments/footer :: footerFragment}"></footer>
</body>

</html>